<!--  
 *     The contents of this file are subject to the Initial 
 *     Developer's Public License Version 1.0 (the "License"); 
 *     you may not use this file except in compliance with the 
 *     License. You may obtain a copy of the License at 
 *     http://www.ibphoenix.com/main.nfs?a=ibphoenix&page=ibp_idpl
 *
 *     Software distributed under the License is distributed on 
 *     an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, either 
 *     express or implied.  See the License for the specific 
 *     language governing rights and limitations under the License.
 *
 *
 *  The Original Code was created by Vladimir Tsvigun for IBPhoenix.
 *
 *  Copyright (c) 2004 Vladimir Tsvigun
 *  All Rights Reserved.
 *
 *  This editing was done by Paul Beach of IBPhoenix
 *
-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1251">
<TITLE>“ип данных Array</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<P><A NAME="hid_data_type_array"></A><h2>“ип данных Array</h2></P>

<P>ѕо умолчанию драйвер представл€ет поле типа массив в виде varchar строки.
 Ёто дает возможность работать с этим типом из программ типа Excel(MsQry32),
 OpenOffice, MsAccess и т.д. ƒл€ изменени€ пол€ типа array, необходимо
 придерживатьс€ некоторых правил:</P>

<P>- ѕростые типы (integer) отображать в виде {1, 2, 3}<BR>
- —троковые типы (char) отображать в виде {'1Т, С2Т, С3Т}<BR>
<BR>ќднако допускаетс€ не указывать фигурные скобки и кавычки.<BR>
&nbsp;&nbsp;
ѕри внесении в новое поле значений, допускаетс€ пропускать елементы через зап€тую,
в этом случае пропущенные пол€ примут значение 0 или ''.</P>

<P><A NAME="editFieldArray"></A><B><IMG SRC="../images/modArrayField.jpg" ALT="" BORDER=0></B></P>

<P>&nbsp;&nbsp;
“еперь рассмотрим некоторые ограничени€. ≈сть программы, которые формируют
SQL запрос на модификацию по всем пол€м в части WHERE. ћы не забываем, что в
нашем случае тип пол€ Array представлен в виде varchar! Ќо, не все так плохо,
в этом случае достаточно любым способом сообщить программе, что поле Array
модифицировалось.  ак правильно обходить эту проблему смотри рисунок ниже.
</P>

<P><A NAME="ruleModArrayField"></A><B><IMG SRC="../images/ruleModArrayField.jpg" ALT="" BORDER=0></B></P>

<P>&nbsp;&nbsp;
Ѕудьте осторожны, на текущий момент этот запрос исковеркает вашу таблицу:<BR>
<BR>
 update "PROJ_DEPT_BUDGET"<BR>
 set    "QUART_HEAD_CNT" = {1,2,3,4,5}<BR>
 where  "year" = '2003' AND "PROJ_ID" = 'MAPDB' AND "DEPT_NO" = '110'<BR>
<BR>
&nbsp;&nbsp;¬озможно будет реализован формат<BR>
	{ar 1,2,3,4,5}<BR>
	или<BR>
	{ar 'текст1','текст2','текст3','текст4','текст5'}<BR>
<BR>
&nbsp;&nbsp;Ётот формат требует преобразовани€ запроса в вид пон€тный
дл€ сервера:
<BR>
 update "PROJ_DEPT_BUDGET"<BR>
 set    "QUART_HEAD_CNT" = ?<BR>
 where  "year" = '2003' AND "PROJ_ID" = 'MAPDB' AND "DEPT_NO" = '110'<BR>
<BR>
 и самоде€тельности драйвера, то есть внутреннее преобразование
запроса, сохранение параметра, и выполнение по более сложной схеме.
</P>

</BODY>
</HTML>
